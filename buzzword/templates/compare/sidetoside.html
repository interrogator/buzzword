{% extends "jbase.html" %}
{% load static %}
{% load martortags %}
{% load widget_tweaks %}
{% block title %}{{corpus.name}}: compare{% endblock %}
{% block content %}

{% include "specific_nav.html" %}

{% if messages %}
  <ul class="messages">
      {% for message in messages %}
          <div style="margin-left: -28px; margin-right: 15px;" class="alert alert-dismissible fade show alert-{{ message.tags }}" role="alert">{{ message }}
              <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
              </button>
          </div>
      {% endfor %}
  </ul>
{% endif %}

{% if text_search %}
<div class="modal modal-click-hide" id="search-results" tabindex="-1" style="background: #fff; position: unset;">
  <form method="post">
    {% csrf_token %}
    <div class="modal-header">
      <h3 class="modal-title">Search results: << {{ search_query }} >> in {{ corpus.name }}</h3>
      <button type="button" class="close modal-click-hide" data-dismiss="modal" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <div class="modal-body" style="background: #fff">


    <table class="table table-sm" data-toggle="table" data-pagination="true" style="cellpadding:0; cellspacing: 0; margin: 0; max-width: 90%vw;">
      <thead>
        <tr>
          <th style="text-align: center !important;">Book</th>
          <th style="text-align: center !important;">Chapter</th>
          <th style="text-align: center !important;">Page</th>
          <th style="text-align: center !important;">Left</th>
          <th style="text-align: center !important;">Match</th>
          <th style="text-align: center !important;">Right</th>
          <th style="text-align: center !important;">Edit</th>
        </tr>
      </thead>
      <tbody>
        {% for result in text_search %}
        <tr style="padding:0px; !important;">
          <td style="max-width: 8vw;">{{ result.book }}</td>
          <td style="max-width: 8vw;">{{ result.chapter }}</td>
          <td style="max-width: 4vw;">{{ result.page }}</td>
          <td style="max-width: 34vw; direction: rtl; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; text-align: right;">{{ result.left }}</td>
          <td style="max-width: 4vw;"><b>{{ result.match }}</b></td>
          <td style="max-width: 34vw; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">{{ result.right }}</td>
          <td style="max-width: 8vw;">
              <a type='button' class='modal-click-hide btn btn-primary float-right' href="?page={{ result.page }}">View</a>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    </div>
    <div class="modal-footer">
    </div>
  </form>
</div>
{% endif %}

<div style="overflow: hidden;">
    <div class="container compare-container">
      <div class="row">
        {% if sections %}
          <div class="col-sm-2 nopad compare-height">
            {% include "compare-sidebar.html" %}
          </div>
        {% endif %}
        <div style="margin-top:10px;" class="col-sm{{ coldata }}">
            <div id="pdf-here">
                <object data={{ pdf_filepath }} type="application/pdf" class="pdf-editor-height" style="min-width: {{ colwidth }}">
                    <embed src={{ pdf_filepath }} type="application/pdf" />
                </object>
                {% include "comparenav.html" %}
            </div>
        </div>
        <div style="margin-top:10px;" class="pdf-editor-height col-sm{{ coldata }}">
            <form method="POST" enctype="multipart/form-data">
                {% csrf_token %}
                <div style="height:70vh; min-width:{{ colwidth }}; margin-left:-10px;">
                    {{ form.description }}
                    <span class="float-right form-check form-check-inline" style="width: 30vw; margin-top:-10px; margin-right:0;">
                        <span>Describe your changes:</span>
                        {{ form.commit_msg }}
                        <button type="submit" style="margin-left: 5px;" class="btn btn-primary">Update</button>
                    </span>
                </div>
            </form>
        </div>
      </div>
    </div>
</div>
{% endblock %}

